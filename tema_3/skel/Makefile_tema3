CC=gcc
CFLAGS=-Wall -Wextra -Wpedantic -m32
OPT_CFLGAS=-O3 -Wno-unused-result

PARSER=parson
PUBL=publications
RUNNER=runner
CHECKER=checker
HASHTABLE=Hashtable
LINKEDLIST=LinkedList
QUEUE=Queue

INCLUDES=-I$(PARSER) -I.
LIBS=-lm

.PHONY: build clean

build: tema3

tema3: main.o runner.o $(PARSER).o $(LINKEDLIST).o $(HASHTABLE).o $(QUEUE).o $(PUBL).o
	$(CC) $^ -o $@ -m32 $(LIBS)

main.o: $(CHECKER)/main.c
	$(CC) $(CFLAGS) $(OPT_CFLGAS) $(INCLUDES) $^ -c

$(RUNNER).o: $(CHECKER)/$(RUNNER).c $(CHECKER)/$(RUNNER).h
	$(CC) $(CFLAGS) $(OPT_CFLGAS) $(INCLUDES) $^ -c

$(PARSER).o: $(PARSER)/$(PARSER).c $(PARSER)/$(PARSER).h
	$(CC) $(CFLAGS) $(OPT_CFLGAS) $^ -c

$(LINKEDLIST).o: $(LINKEDLIST).c $(LINKEDLIST).h
	make --no-print-directory build	

 $(HASHTABLE).o: $(HASHTABLE).c $(HASHTABLE).h
	make --no-print-directory build

 $(QUEUE).o: $(QUEUE).c $(QUEUE).h
	make --no-print-directory build

$(PUBL).o: $(PUBL).c $(PUBL).h
	make --no-print-directory build

clean:
	rm -f *.o tema3
	rm -f $(PARSER)/*.h.gch
	rm -f $(CHECKER)/*.h.gch
	make --no-print-directory clean
